<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>授信主体账号</title>
	<meta charset="utf-8" />
    <link href="../Content/easyui/themes/bootstrap/easyui.css" rel="stylesheet" />
    <link href="../Content/easyui/themes/icon.css" rel="stylesheet" />
    <link href="../Content/form-bootstrap.css" rel="stylesheet" />
    <script src="../Scripts/jquery/jquery.js"></script>
    <script src="../Scripts/easyui/jquery.easyui.js"></script>
    <script src="../Scripts/easyui/locale/easyui-lang-zh_CN.js"></script>
    <script src="../Scripts/usedcars.js"></script>
    <script>
        uc.form = new UCForm("#creditAccount_ff");
        
        $(function () {
            Init();

            $.extend($.fn.validatebox.defaults.rules, {
                //重复验证
                checkUsernameRepeat: {
                    validator: function (value, param) {
                        var result = false;

                        $.ajax({
                            async: false,
                            data: { username: value },
                            type: "GET",
                            url: "../api/User/CheckUsername",
                            statusCode: {
                                200: function (data) {
                                    result = true;
                                }
                            }
                        });

                        return result;
                    },
                    message: '用户名已使用!'
                },
                //帐号
                checkUsernameFormat: {
                    validator: function (value) {
                        return /^[a-z\_]{1}\w{1,18}$/i.test(value);
                    },
                    message: "请输入正确的用户名，由字母、数字和下划线组成。不可以数字开头,长度在2-18位之间!"
                }
            });
        });

        function Init() {
            var query = uc.GetParams();
            if (query.method == "mod" || query.method == "view") {
                if (query.method == "mod") {
                    $("input[textboxname='Username']").textbox("disable");
                }

                if (query.method == "view") {
                    $("#save").linkbutton("disable");

                    uc.form.DisableForm();
                }

                uc.form.LoadForm({
                    params: { userId: query.userId },
                    url: "../api/CreditAccount/Get"
                });
            }
        }

        function Submit() {
            var value = $("#creditAccount_ff").serializeJson();
            uc.form.Submit({
                url: "../api/CreditAccount",
                method: "auto",
                data: value
            });
        }

    </script>
</head>
<body>
    <form id="creditAccount_ff" class="container">
        <fieldset id="userinfo">
            <legend>授信主体账号信息</legend>

            <div id="data">
                <input name="UserId" type="hidden" />
            </div>

            <div class="row">
                <div class="col-6">
                    <label>帐号:</label>
                    <input name="Username" class="easyui-textbox" data-options="
                           required:true,
                           validType:['checkUsernameRepeat', 'checkUsernameFormat' ],
                           delay:800
                           " />
                </div>
                <div class="col-6">
                    <label>所属授信主体:</label>
                    <select name="CreditId" class="easyui-combobox" data-options="
                            method: 'GET' ,
                            url:'../api/Credit/Option',
                            required:true,
                            editable:false
                    "></select>
                </div>
            </div>

            <div class="row">
                <div class="col-6">
                    <label>姓名:</label>
                    <input name="Name" class="easyui-textbox" data-options="required:true" />
                </div>

                <div class="col-6">
                    <label>角色:</label>
                    <select name="RoleId" class="easyui-combobox" data-options="required:true,editable:false">
                        <option value="8">客户经理</option>
                        <option value="9">渠道经理</option>
                    </select>
                </div>
            </div>
            <div class="row">
                <div class="col-6">
                    <label>手机:</label>
                    <input name="Mobile" class="easyui-textbox" data-options="validType:'Mobile'" />
                </div>
                <div class="col-6">
                    <label>邮箱:</label>
                    <input name="Email" class="easyui-textbox" data-options="validType:'Email'" />
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <label>备注:</label>
                    <input name="Remarks" class="easyui-textbox" data-options="multiline:true,height:66" />
                </div>
            </div>
        </fieldset>
        <div id="btn">
            <a href="javascript:void(0)" id="save" class="easyui-linkbutton" data-options="iconCls:'icon-save',onClick:Submit">保存</a>
            <a href="javascript:void(0)" id="back" class="easyui-linkbutton" data-options="iconCls:'icon-redo',onClick:uc.form.Cancel">返回</a>
        </div>
    </form>
</body>
</html>
